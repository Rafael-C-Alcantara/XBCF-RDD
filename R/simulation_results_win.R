setwd("~/../Git/BART-RDD/")
files <- length(list.files("Data"))
##
params <- data.frame(het=rep(0,files),str=rep(0,files))
##
bart.rdd.ate <- vector("list",files)
bcf.ate <- vector("list",files)
sbart.ate <- vector("list",files)
tbart.ate <- vector("list",files)
cgs.ate <- vector("list",files)
llr.ate <- vector("list",files)
##
rmse.bart <- rep(0,files)
sb.bart <- rep(0,files)
v.bart <- rep(0,files)
ci.bart <- rep(0,files)
cov.bart <- rep(0,files)
zero.bart <- rep(0,files)
bart.rdd.cate <- rep(0,files)
bart.rdd.cate.cov <- rep(0,files)
bart.rdd.cate.ci <- rep(0,files)
##
rmse.bcf <- rep(0,files)
sb.bcf <- rep(0,files)
v.bcf <- rep(0,files)
ci.bcf <- rep(0,files)
cov.bcf <- rep(0,files)
zero.bcf <- rep(0,files)
bcf.cate <- rep(0,files)
bcf.cate.cov <- rep(0,files)
bcf.cate.ci <- rep(0,files)
##
rmse.sbart <- rep(0,files)
sb.sbart <- rep(0,files)
v.sbart <- rep(0,files)
ci.sbart <- rep(0,files)
cov.sbart <- rep(0,files)
zero.sbart <- rep(0,files)
sbart.cate <- rep(0,files)
sbart.cate.cov <- rep(0,files)
sbart.cate.ci <- rep(0,files)
##
rmse.tbart <- rep(0,files)
sb.tbart <- rep(0,files)
v.tbart <- rep(0,files)
ci.tbart <- rep(0,files)
cov.tbart <- rep(0,files)
zero.tbart <- rep(0,files)
tbart.cate <- rep(0,files)
tbart.cate.cov <- rep(0,files)
tbart.cate.ci <- rep(0,files)
##
# rmse.llr0 <- matrix(0,files,3)
# sb.llr0 <- matrix(0,files,3)
# v.llr0 <- matrix(0,files,3)
# ci.llr0 <- matrix(0,files,3)
# cov.llr0 <- matrix(0,files,3)
# zero.llr0 <- matrix(0,files,3)
##
rmse.llr1 <- matrix(0,files,3)
sb.llr1 <- matrix(0,files,3)
v.llr1 <- matrix(0,files,3)
ci.llr1 <- matrix(0,files,3)
cov.llr1 <- matrix(0,files,3)
zero.llr1 <- matrix(0,files,3)
##
# rmse.llr2 <- matrix(0,files,3)
# sb.llr2 <- matrix(0,files,3)
# v.llr2 <- matrix(0,files,3)
# ci.llr2 <- matrix(0,files,3)
# cov.llr2 <- matrix(0,files,3)
# zero.llr2 <- matrix(0,files,3)
##
# rmse.cgs0 <- rep(0,files)
# sb.cgs0 <- rep(0,files)
# v.cgs0 <- rep(0,files)
# ci.cgs0 <- rep(0,files)
# cov.cgs0 <- rep(0,files)
# zero.cgs0 <- rep(0,files)
##
rmse.cgs1 <- rep(0,files)
sb.cgs1 <- rep(0,files)
v.cgs1 <- rep(0,files)
ci.cgs1 <- rep(0,files)
cov.cgs1 <- rep(0,files)
zero.cgs1 <- rep(0,files)
##
for (i in 1:files)
{
  data <- readRDS(paste0("Data/dgp_",i,".rds"))
  ate <- colMeans(data$tau)
  params[i,] <- c(data$het,data$str)
  bart <- readRDS(paste0("Results/bart_rdd_",i,".rds"))
  bcf <- readRDS(paste0("Results/bcf_",i,".rds"))
  sbart <- readRDS(paste0("Results/sbart_",i,".rds"))
  tbart <- readRDS(paste0("Results/tbart_",i,".rds"))
  # llr0 <- readRDS(paste0("Results/llr0_",i,".rds"))
  llr1 <- readRDS(paste0("Results/llr1_",i,".rds"))
  ## llr2 <- readRDS(paste0("Results/llr2_",i,".rds"))
  # cgs0 <- readRDS(paste0("Results/cgs0_",i,".rds"))
  cgs1 <- readRDS(paste0("Results/cgs1_",i,".rds"))
  ##
  bart.rdd.ate[[i]] <- sapply(bart$results,colMeans)
  rmse.bart[i] <- sqrt(mean((sapply(bart$results,mean)-ate)^2))
  sb.bart[i] <- mean(sapply(bart$results,mean)-ate)^2
  v.bart[i] <- var(sapply(bart$results,mean))
  ci.bart[i] <- mean(sapply(bart$results,function(i) quantile(colMeans(i),0.975)-quantile(colMeans(i),0.025)))
  cov.bart[i] <- mean(sapply(bart$results,function(i) quantile(colMeans(i),0.975))-ate>0 & sapply(bart$results,function(i) quantile(colMeans(i),0.025))-ate<0)
  zero.bart[i] <- mean(sapply(bart$results,function(i) quantile(colMeans(i),0.975))>0 & sapply(bart$results,function(i) quantile(colMeans(i),0.025))<0)
  ## CATE
  h <- apply(data$x,2,function(i) -0.5*sd(i) < i & i < 0.5*sd(i))
  cate <- sapply(1:ncol(data$x),function(i) data$tau[h[,i],i])
  bart.cate <- sapply(bart$results,rowMeans)
  bart.rdd.cate[i] <- mean(sapply(1:ncol(data$x),function(i) sqrt(mean((bart.cate[[i]]-cate[[i]])^2))))
  bart.rdd.cate.int <- lapply(bart$results,function(i) t(apply(i,1,quantile,c(0.025,0.975))))
  bart.rdd.cate.cov[i] <- mean(sapply(1:length(bart.rdd.cate.int), function(i) mean(bart.rdd.cate.int[[i]][,1]<cate[[i]] & cate[[i]] < bart.rdd.cate.int[[i]][,2])))
  bart.rdd.cate.ci[i] <- mean(sapply(1:length(bart.rdd.cate.int), function(i) mean(-bart.rdd.cate.int[[i]][,1] + bart.rdd.cate.int[[i]][,2])))
  ##
  bcf.ate[[i]] <- sapply(bcf$results,colMeans)
  rmse.bcf[i] <- sqrt(mean((sapply(bcf$results,mean)-ate)^2))
  sb.bcf[i] <- mean(sapply(bcf$results,mean)-ate)^2
  v.bcf[i] <- var(sapply(bcf$results,mean))
  ci.bcf[i] <- mean(sapply(bcf$results,function(i) quantile(colMeans(i),0.975)-quantile(colMeans(i),0.025)))
  cov.bcf[i] <- mean(sapply(bcf$results,function(i) quantile(colMeans(i),0.975))-ate>0 & sapply(bcf$results,function(i) quantile(colMeans(i),0.025))-ate<0)
  zero.bcf[i] <- mean(sapply(bcf$results,function(i) quantile(colMeans(i),0.975))>0 & sapply(bcf$results,function(i) quantile(colMeans(i),0.025))<0)
  ## CATE
  bcf.cate[i] <- mean(sqrt(colMeans((sapply(bcf$results,rowMeans)-data$tau)^2)))
  bcf.cate.int <- lapply(bcf$results,function(i) t(apply(i,1,quantile,c(0.025,0.975))))
  bcf.cate.cov[i] <- mean(sapply(1:length(bcf.cate.int), function(i) mean(bcf.cate.int[[i]][,1]<data$tau[,i] & data$tau[,i] < bcf.cate.int[[i]][,2])))
  bcf.cate.ci[i] <- mean(sapply(1:length(bcf.cate.int), function(i) mean(-bcf.cate.int[[i]][,1] + bcf.cate.int[[i]][,2])))
  ##
  sbart.ate[[i]] <- sapply(sbart$results,colMeans)
  rmse.sbart[i] <- sqrt(mean((sapply(sbart$results,mean)-ate)^2))
  sb.sbart[i] <- mean(sapply(sbart$results,mean)-ate)^2
  v.sbart[i] <- var(sapply(sbart$results,mean))
  ci.sbart[i] <- mean(sapply(sbart$results,function(i) quantile(colMeans(i),0.975)-quantile(colMeans(i),0.025)))
  cov.sbart[i] <- mean(sapply(sbart$results,function(i) quantile(colMeans(i),0.975))-ate>0 & sapply(sbart$results,function(i) quantile(colMeans(i),0.025))-ate<0)
  zero.sbart[i] <- mean(sapply(sbart$results,function(i) quantile(colMeans(i),0.975))>0 & sapply(sbart$results,function(i) quantile(colMeans(i),0.025))<0)
  ## CATE
  sbart.cate[i] <- mean(sqrt(colMeans((sapply(sbart$results,rowMeans)-data$tau)^2)))
  sbart.cate.int <- lapply(sbart$results,function(i) t(apply(i,1,quantile,c(0.025,0.975))))
  sbart.cate.cov[i] <- mean(sapply(1:length(sbart.cate.int), function(i) mean(sbart.cate.int[[i]][,1]<data$tau[,i] & data$tau[,i] < sbart.cate.int[[i]][,2])))
  sbart.cate.ci[i] <- mean(sapply(1:length(sbart.cate.int), function(i) mean(-sbart.cate.int[[i]][,1] + sbart.cate.int[[i]][,2])))
  ##
  tbart.ate[[i]] <- sapply(tbart$results,colMeans)
  rmse.tbart[i] <- sqrt(mean((sapply(tbart$results,mean)-ate)^2))
  sb.tbart[i] <- mean(sapply(tbart$results,mean)-ate)^2
  v.tbart[i] <- var(sapply(tbart$results,mean))
  ci.tbart[i] <- mean(sapply(tbart$results,function(i) quantile(colMeans(i),0.975)-quantile(colMeans(i),0.025)))
  cov.tbart[i] <- mean(sapply(tbart$results,function(i) quantile(colMeans(i),0.975))-ate>0 & sapply(tbart$results,function(i) quantile(colMeans(i),0.025))-ate<0)
  zero.tbart[i] <- mean(sapply(tbart$results,function(i) quantile(colMeans(i),0.975))>0 & sapply(tbart$results,function(i) quantile(colMeans(i),0.025))<0)
  ## CATE
  tbart.cate[i] <- mean(sqrt(colMeans((sapply(tbart$results,rowMeans)-data$tau)^2)))
  tbart.cate.int <- lapply(tbart$results,function(i) t(apply(i,1,quantile,c(0.025,0.975))))
  tbart.cate.cov[i] <- mean(sapply(1:length(tbart.cate.int), function(i) mean(tbart.cate.int[[i]][,1]<data$tau[,i] & data$tau[,i] < tbart.cate.int[[i]][,2])))
  tbart.cate.ci[i] <- mean(sapply(1:length(tbart.cate.int), function(i) mean(-tbart.cate.int[[i]][,1] + tbart.cate.int[[i]][,2])))
  ##
  # rmse.llr0[i,] <- sqrt(rowMeans((sapply(llr0$results,function(i) i$coef)-ate)^2))
  # sb.llr0[i,] <- rowMeans(sapply(llr0$results,function(i) i$coef)-ate)^2
  # v.llr0[i,] <- apply(sapply(llr0$results,function(i) i$coef),1,var)
  # ci.llr0[i,] <- rowMeans(sapply(llr0$results,function(i) i$ci[,2]-i$ci[,1]))
  # cov.llr0[i,] <- rowMeans(sapply(llr0$results,function(i) i$ci[,2])-ate>0 & sapply(llr0$results,function(i) i$ci[,1])-ate<0)
  # zero.llr0[i,] <- rowMeans(sapply(llr0$results,function(i) i$ci[,2])>0 & sapply(llr0$results,function(i) i$ci[,1])<0)
  ##
  llr.ate[[i]] <- t(sapply(llr1$results,function(i) c(i$coef[1],i$ci[1,])))
  rmse.llr1[i,] <- sqrt(rowMeans((sapply(llr1$results,function(i) i$coef)-ate)^2))
  sb.llr1[i,] <- rowMeans(sapply(llr1$results,function(i) i$coef)-ate)^2
  v.llr1[i,] <- apply(sapply(llr1$results,function(i) i$coef),1,var)
  ci.llr1[i,] <- rowMeans(sapply(llr1$results,function(i) i$ci[,2]-i$ci[,1]))
  cov.llr1[i,] <- rowMeans(sapply(llr1$results,function(i) i$ci[,2])-ate>0 & sapply(llr1$results,function(i) i$ci[,1])-ate<0)
  zero.llr1[i,] <- rowMeans(sapply(llr1$results,function(i) i$ci[,2])>0 & sapply(llr1$results,function(i) i$ci[,1])<0)
  ##
  # rmse.llr2[i,] <- rowMeans((sapply(llr2$results,function(i) i$coef)-ate)^2)
  # sb.llr2[i,] <- rowMeans(sapply(llr2$results,function(i) i$coef)-ate)^2
  # v.llr2[i,] <- apply(sapply(llr2$results,function(i) i$coef),1,var)
  # ci.llr2[i,] <- rowMeans(sapply(llr2$results,function(i) i$ci[,2]-i$ci[,1]))
  # cov.llr2[i,] <- rowMeans(sapply(llr2$results,function(i) i$ci[,2])-ate>0 & sapply(llr2$results,function(i) i$ci[,1])-ate<0)
  # zero.llr2[i,] <- rowMeans(sapply(llr2$results,function(i) i$ci[,2])>0 & sapply(llr2$results,function(i) i$ci[,1])<0)
  ##
  # cgs.res <- t(apply(sapply(cgs0$results,function(i) i$atem),2,function(i) c(mean(i),quantile(i,c(0.025,0.975)))))
  # rmse.cgs0[i] <- sqrt(mean((cgs.res[,1]-ate)^2))
  # sb.cgs0[i] <- mean(cgs.res[,1]-ate)^2
  # v.cgs0[i] <- var(cgs.res[,1])
  # ci.cgs0[i] <- mean(cgs.res[,3]-cgs.res[,2])
  # cov.cgs0[i] <- mean(cgs.res[,3]-ate>0 & cgs.res[,2]-ate<0)
  # zero.cgs0[i] <- mean(cgs.res[,3]>0 & cgs.res[,2]<0)
  ##
  cgs.ate[[i]] <- t(sapply(cgs1$results, function(i) c(mean(i$atem),quantile(i$atem,c(0.025,0.975)))))
  cgs.res <- t(apply(sapply(cgs1$results,function(i) i$atem),2,function(i) c(mean(i),quantile(i,c(0.025,0.975)))))
  rmse.cgs1[i] <- sqrt(mean((cgs.res[,1]-ate)^2))
  sb.cgs1[i] <- mean(cgs.res[,1]-ate)^2
  v.cgs1[i] <- var(cgs.res[,1])
  ci.cgs1[i] <- mean(cgs.res[,3]-cgs.res[,2])
  cov.cgs1[i] <- mean(cgs.res[,3]-ate>0 & cgs.res[,2]-ate<0)
  zero.cgs1[i] <- mean(cgs.res[,3]>0 & cgs.res[,2]<0)
}
##
names <- c("BART-RDD","BCF","S-BART","T-BART","CGS","LLR")
###
rmse <- cbind(rmse.bart,rmse.bcf,rmse.sbart,rmse.tbart,rmse.cgs1,rmse.llr1[,1])
colnames(rmse) <- names
table(apply(rmse,1,function(i) which(i==min(i))))
###
sb <- cbind(sb.bart,sb.bcf,sb.sbart,sb.tbart,sb.cgs1,sb.llr1[,1])
colnames(sb) <- names
table(apply(sb,1,function(i) which(i==min(i))))
###
v <- cbind(v.bart,v.bcf,v.sbart,v.tbart,v.cgs1,v.llr1[,1])
colnames(v) <- names
table(apply(v,1,function(i) which(i==min(i))))
###
ci <- cbind(ci.bart,ci.bcf,ci.sbart,ci.tbart,ci.cgs1,ci.llr1[,1])
colnames(ci) <- names
table(apply(ci,1,function(i) which(i==min(i))))
###
cov <- cbind(cov.bart,cov.bcf,cov.sbart,cov.tbart,cov.cgs1,cov.llr1[,1])
colnames(cov) <- names
zero <- cbind(zero.bart,zero.bcf,zero.sbart,zero.tbart,zero.cgs1,zero.llr1[,1])
colnames(zero) <- names
###
bart.rdd.int <- sapply(lapply(bart.rdd.ate,function(i) apply(i,2,function(j) c(0.05-quantile(j,0.025),quantile(j,0.975)-0.05))),function(i) quantile(apply(i,2,function(j) ifelse(min(j)>0,0,abs(min(j)))),0.95))
bcf.int <- sapply(lapply(bcf.ate,function(i) apply(i,2,function(j) c(0.05-quantile(j,0.025),quantile(j,0.975)-0.05))),function(i) quantile(apply(i,2,function(j) ifelse(min(j)>0,0,abs(min(j)))),0.95))
sbart.int <- sapply(lapply(sbart.ate,function(i) apply(i,2,function(j) c(0.05-quantile(j,0.025),quantile(j,0.975)-0.05))),function(i) quantile(apply(i,2,function(j) ifelse(min(j)>0,0,abs(min(j)))),0.95))
tbart.int <- sapply(lapply(tbart.ate,function(i) apply(i,2,function(j) c(0.05-quantile(j,0.025),quantile(j,0.975)-0.05))),function(i) quantile(apply(i,2,function(j) ifelse(min(j)>0,0,abs(min(j)))),0.95))
llr.int <- sapply(llr.ate, function(i) quantile(apply(i,1,function(j) ifelse(0.05-j[2]>0 & j[3]-0.05>0,0,abs(min(0.05-j[2],j[3]-0.05)))),0.95))
cgs.int <- sapply(cgs.ate, function(i) quantile(apply(i,1,function(j) ifelse(0.05-j[2]>0 & j[3]-0.05>0,0,abs(min(0.05-j[2],j[3]-0.05)))),0.95))
int <- cbind(bart.rdd.int,bcf.int,sbart.int,tbart.int,cgs.int,llr.int)
colnames(int) <- names
###
rmse.cate <- cbind(bart.rdd.cate,bcf.cate,sbart.cate,tbart.cate)
colnames(rmse.cate) <- names[1:4]
table(apply(rmse.cate,1,function(i) which(i==min(i))))
###
cov.cate <- cbind(bart.rdd.cate.cov,bcf.cate.cov,sbart.cate.cov,tbart.cate.cov)
colnames(cov.cate) <- names[1:4]
###
ci.cate <- cbind(bart.rdd.cate.ci,bcf.cate.ci,sbart.cate.ci,tbart.cate.ci)
colnames(ci.cate) <- names[1:4]
## Tables
stargazer::stargazer(cbind(params,round(rmse,3)),summary=F,rownames = F)
stargazer::stargazer(cbind(params,round(cov,3)),summary=F,rownames = F)
stargazer::stargazer(cbind(params,round(ci,3)),summary=F,rownames = F)
stargazer::stargazer(cbind(params,round(rmse.cate,3)),summary=F,rownames = F)
stargazer::stargazer(cbind(params,round(cov.cate,3)),summary=F,rownames = F)
stargazer::stargazer(cbind(params,round(ci.cate,3)),summary=F,rownames = F)
## Plots
pdf("Figures/sim_rmse.pdf")
par(mfrow=c(2,2))
matplot(rmse,type="n",bty="n",xlab=expression(kappa),ylab="RMSE",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(rmse[1:3,],type="b",lty=1,pch=20)
matlines(4:6,rmse[4:6,],type="b",lty=1,pch=20)
matlines(7:9,rmse[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(sqrt(sb),type="n",bty="n",xlab=expression(kappa),ylab="Absolute Bias",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(sqrt(sb)[1:3,],type="b",lty=1,pch=20)
matlines(4:6,sqrt(sb)[4:6,],type="b",lty=1,pch=20)
matlines(7:9,sqrt(sb)[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(sqrt(v),type="n",bty="n",xlab=expression(kappa),ylab="Std. Dev.",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(sqrt(v)[1:3,],type="b",lty=1,pch=20)
matlines(4:6,sqrt(v)[4:6,],type="b",lty=1,pch=20)
matlines(7:9,sqrt(v)[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
plot.new()
legend("center",ncol = 2,col=1:6, lty=1, pch=20, cex=0.8, legend = names)
dev.off()
###
pdf("Figures/sim_intervals.pdf")
par(mfrow=c(2,2))
matplot(cov,type="n",bty="n",xlab=expression(kappa),ylab="Coverage",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(cov[1:3,],type="b",lty=1,pch=20)
matlines(4:6,cov[4:6,],type="b",lty=1,pch=20)
matlines(7:9,cov[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(ci,type="n",bty="n",xlab=expression(kappa),ylab="Interval size",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(ci[1:3,],type="b",lty=1,pch=20)
matlines(4:6,ci[4:6,],type="b",lty=1,pch=20)
matlines(7:9,ci[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(int,type="n",bty="n",xlab=expression(kappa),ylab="Distance to 95% coverage",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(int[1:3,],type="b",lty=1,pch=20)
matlines(4:6,int[4:6,],type="b",lty=1,pch=20)
matlines(7:9,int[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
plot.new()
legend("center",ncol = 2,col=1:6, lty=1, pch=20, cex=0.8, legend = names)
dev.off()
###
pdf("Figures/sim_rmse_cate.pdf")
par(mfrow=c(1,1))
matplot(rmse.cate,type="n",bty="n",xlab=expression(kappa),ylab="RMSE",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(rmse.cate[1:3,],type="b",lty=1,pch=20)
matlines(4:6,rmse.cate[4:6,],type="b",lty=1,pch=20)
matlines(7:9,rmse.cate[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
legend("topleft",ncol = 2,col=1:4, lty=1, pch=20, cex=0.6, legend = names[1:4])
dev.off()
###
pdf("Figures/sim_intervals_cate.pdf")
par(mfrow=c(2,2))
matplot(rmse.cate,type="n",bty="n",xlab=expression(kappa),ylab="RMSE",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(rmse.cate[1:3,],type="b",lty=1,pch=20)
matlines(4:6,rmse.cate[4:6,],type="b",lty=1,pch=20)
matlines(7:9,rmse.cate[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(cov.cate,type="n",bty="n",xlab=expression(kappa),ylab="Coverage",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(cov.cate[1:3,],type="b",lty=1,pch=20)
matlines(4:6,cov.cate[4:6,],type="b",lty=1,pch=20)
matlines(7:9,cov.cate[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
matplot(ci.cate,type="n",bty="n",xlab=expression(kappa),ylab="Interval size",xaxt="n")
axis(1,at=c(2,5,8),labels=c(0,1,2))
matlines(ci.cate[1:3,],type="b",lty=1,pch=20)
matlines(4:6,ci.cate[4:6,],type="b",lty=1,pch=20)
matlines(7:9,ci.cate[7:9,],type="b",lty=1,pch=20)
abline(v=3.5,lty=2)
abline(v=6.5,lty=2)
plot.new()
legend("center",ncol = 2,col=1:4, lty=1, pch=20, cex=0.8, legend = names[1:4])
dev.off()
###
pdf("Figures/rmse_boxplot.pdf")
par(mfrow=c(2,1))
boxplot(rmse,main="ATE",bty="n",las=3,cex.axis=0.7)
boxplot(rmse.cate,main="CATE",bty="n",las=3,cex.axis=0.7)
dev.off()