x
y
w
q()
n
q()
n
fit.XBCFrd
q()
n
?q
install.packages("jsonlite")
fromJSON(fit.XBCFrd$tree_json_mod,simplify=F)
fromJSON(fit.XBCFrd$tree_json_mod,simplifyVectir=F)
fromJSON(fit.XBCFrd$tree_json_mod,simplifyVector=F)
names(trees_json)
trees_json$num_trees
trees_json$num_sweeps
trees_json$y_mean
names(trees_json$trees)
trees_json$trees$0
trees_json$trees$`0`
q("no")
cgs
results
cgs
q()
n
q("no")
q("no")
q("no")
results[["XBCF-RDD"]]
q("no")
dst.dates
dst.dates
dst.dates
dst.dates
dst.dates[year=="2017",]
subset(dst.dates,year=="2017",select=start)
?subset
subset(dst.dates,year==2017,select=start)
subset(dst.dates,subset=year==2017,select=start)
class(dst.dates)
subset(as.data.frame(dst.dates),year=="2017",select=start)
dst.dates
summary(dst.dates)
subset(dst.dates,year==2017,select=start)
class(subset(dst.dates,year==2017,select=start))
class(unlist(subset(dst.dates,year==2017,select=start)))
as.Date(subset(dst.dates,year==2017,select=start))
as.Date(unlist(subset(dst.dates,year==2017,select=start)))
as.Date(paste0("2017-",unlist(subset(dst.dates,year==2017,select=start))))
dst.date
data
i
get_stats19(year=2005,type="accident",ask=F)
get_stats19(year=2005,ask=F)
get_stats19(year=2006,ask=F)
get_stats19(year=2010,ask=F)
0
get_stats19(year=2011,ask=F)
0
get_stats19(year=2015,ask=F)
get_stats19(year=2016,ask=F)
stats19::file_names
get_stats19(year=1979,ask=F)
get_stats19(year=1979,type="casualty",ask=F)
dl_stats19(1979)
3
dl_stats19(filename="https://data.dft.gov.uk/road-accidents-safety-data/dft-road-casualty-statistics-accident-1979-2021.csv")
q("no")
dl_stats19(file_name="https://data.dft.gov.uk/road-accidents-safety-data/dft-road-casualty-statistics-accident-1979-2021.csv")
1
q("no")
stats19::file_names
stats19::file_names_old
stats19::find_file_name
find_file_name(1979)
stats19::file_names
unlist(stats19::file_names)
length(stats19::file_names)
q("no")
head(data)
dst.dates
aggregate(number_of_casualties~time,data=data,sum)
head(data)
head(subset(data,substr(date,7,10) >= 2005 & substr(date,7,10) <= 2018))
dim(data0
cim(data)
dim(data)
head(data)
dst.dates
dst.date
j
data$date[j]
as.Date(data$date[j])
as.Date(data$date[j])-as.Date(dst.date)
as.Date(data$date[j],format="d/m/Y")-as.Date(dst.date)
as.Date(data$date[j],format="d/m/y")
as.Date(data$date[j],format="d/m/Y")
as.Date(data$date[j],format="%d/%m/%Y")
as.Date(data$date[j],format="%d/%m/%Y")-as.Date(dst.date,format="%d/%m/%Y")
j
dim(data)
as.Date(data$date[j],format="%d/%m/%Y")
as.Date(data$date[j],format="%d/%m/%Y")-as.Date(dst.date,format="%d/%m/%Y")
as.Date(dst.date,format="%d/%m/%Y")
substr(data$date[j],7,10)
substr(data$date[j],7,10)==i
i
q("no")
i
j
head(data)
table(data$run.var)
as.Date(data$date,format="%d/%m/%Y")
as.Date(substr(data$date,1,5),format="%d/%m")
i
j
names(data)
data$accident_year
merge(data,dst.dates)
head(data)
as.numeric(data$accident_year)
head(data)
data.table::setkey(data,"accident_year")
data.table::setkey(dst.dates,"year")
data.table::setkey(data.table::as.data.table(dst.dates),"year")
data[dst.dates]
?merge
merge(data,dst.dates,by.x="accident_year",by.y="year")
merge(data,dst.dates,by.x="accident_year",by.y="year")
as.Date(data$date,format="%d/%m/%Y")-as.Date(paste0(data$start,"/",data$accident_year),format="%d/%m/%Y")
head(data)
dim(data)
head(data)
data$t
head(data)
head(data)
plot(data$x,data$run.var)
head(data)
plot(aggregate(y~x,data=data,sum))
 data$x <0
aggregate(data$y,data$x<0)
aggregate(data$y,data$x<0,sum)
aggregate(data$y,list(pre=data$x<0),sum)
head(data)
table(data$x)
substr(data$time,1,2)<=1
data$run.var==0 & substr(data$time,1,2)<=1
data$run.var==0
data$x==0 & substr(data$time,1,2)<=1
table(data$x==0 & substr(data$time,1,2)<=1)
dim(data)
dim(na.omit(data))
table(data$latitude)
summary(data$latitude)
is.na(data$latitude)
table(is.na(data$latitude))
table(is.na(data$longitude))
table(is.na(data$time))
0.0002*nrow(data)
head(data)
head(data)
head(data)
rdrobust::rdrobust(y=data$y,x=data$x,c=0,covs=cbind(as.factor(data$i),as.factor(data$t),as.factor(data$z)))
summary(cct)
names(data)
summary(cct)
summary(cct)
summary(cct)
plot(aggregate(y~x,data,sum))
cct$bws
cct$bws[2,2\
cct$bws[2,2]
data[data$x>=-cct$bws[2,2]&x<=cct$bws[2,2],"y"]
data[data$x>=-cct$bws[2,2]&data$x<=cct$bws[2,2],"y"]
data[data$x>=-cct$bws[2,2]&data$x<0,"y"]
sum(data[data$x>=-cct$bws[2,2]&data$x<0,"y"])
sum(data[data$x<=cct$bws[2,2]&data$x>=0,"y"])
sum(data[data$x>=-cct$bws[1,1]&data$x<0,"y"])
sum(data[data$x<=cct$bws[1,1]&data$x>=0,"y"])
plot(data$x,data$y)
data[, (cols):=lapply(.SD, as.factor), .SDcols=cols]
data.table::as.data.table(data)[, (cols):=lapply(.SD, as.factor), .SDcols=cols]
data.table::as.data.table(data)[, (year):=lapply(.SD, as.factor), .SDcols=year]
data.table::as.data.table(data)[, (z):=lapply(.SD, as.factor), .SDcols=z]
rdrobust::rdbwselect(data$y,data$x,c=0,covs=cbind(as.factor(data$t),as.factor(data$i),as.factor(data$z)))
summary(rdrobust::rdbwselect(data$y,data$x,c=0,covs=cbind(as.factor(data$t),as.factor(data$i),as.factor(data$z))))
head(data)
data$x-21
data$x+22
table(data$x+22)
table(data$k2)
table(data$kt2)
table(data$kt1)
summary(cct)
head(data)
cct$bws
summary(reg)
cct
cct$bws
cct$bws[[1]]
cct$bws[[2]]
summary(reg)
?coeftest
?lmtest::coeftest
lmtest::coeftest(reg,vcov=sandwich::vcovHC(reg,type="HC0"))
lmtest::coeftest(reg,vcov=sandwich::vcovHC(reg))
library(XBART)
xbcf.fit <- XBCF.rd(y=data$y,W=data[,c("kt1","kt2","i","t","z")],X=data$x,c=0,Owidth=0.1,Omin=2,Opct=0.9)
apply(data,2,class)
head(data)
rm(xbcf.fit)
q("no")
summary(reg)
Owidth
cutpoints(0)
cutpoints(1)
table(x>=-1&x<=1
)
Owidth
ate.xbcf
y
head(data)
x
hist(x)
test.data <- cbind(y,w,x)
test.data <- test.data[sample(1:nrow(test.data),100),]
dim(test.data)
y <- test.data$y
y <- test.data[,"y"]
y
x <- test.data[,"x"]
head(test.data)
w <- test.data[,2:3]
w
stop()
q("no")
q("no")
q("no")
n <- 10
p_cat <- 2
p_con <- 2
cbind(matrix(rnorm(n*p_con), n, p_con), matrix(sample(c(-0.5, 0, 0.5), n * p_cat, replace = TRUE), n, p_cat))
apply(cbind(matrix(rnorm(n*p_con), n, p_con), matrix(sample(c(-0.5, 0, 0.5), n * p_cat, replace = TRUE), n, p_cat)),2,class)
table(w$no_sewer)
table(w$old_sewer)
cutpoints(Owidth)
findOwidth(0.01)
findOwidth(0.01)
summary(x)
cutpoints(1)
cutpoints(0.9)
cutpoints(0.99)
cutpoints(0.999)
cutpoints(2)
cutpoints(1)
cutpoints(10)
cutpoints(1.2)
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
names(trees.json)
trees.json$trees
trees.json <- fit.XBCFrd$tree_json_con
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
pred.XBCFrd$tau.adj
pred.XBCFrd$mu.adj
trees.json <- fit.XBCFrd$tree_json_con
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
pred.XBCFrd$tau.adj
pred.XBCFrd$mu.adj
pred.XBCFrd$tau.adj
head(pred.XBCFrd$tau.adj)
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
Owidth <- 1
trees.json <- fit.XBCFrd$tree_json_mod
trees.json <- jsonlite::parse_json(trees.json)
trees.json$trees
pred.XBCFrd$tau.adj
q("no")
by
by(tau,data$dist_police<290 & data$dist_pub>=51,post.sum)
tau
by(tau,data[test,]$dist_police<290 & data[test,]$dist_pub>=51,post.sum)
by(tau,data[test,]$dist_police<290 & data[test,]$dist_pub<51,post.sum)
by(tau,data[test,]$dist_police<290,post.sum)
summary(cct2)
by(tau,data[test,]$dist_pub>=51,post.sum)
by(tau,data[test,]$dist_pub>=35,post.sum)
by(tau,data[test,]$dist_pub>=68,post.sum)
by(tau,data[test,]$dist_police<290,post.sum)
by(tau,data[test,]$dist_police<360,post.sum)
aggregate(tau,quantile(data[test,]$dist_police,seq(0.1,1,0.1)),post.sum)
aggregate(tau,list=quantile(data[test,]$dist_police,seq(0.1,1,0.1)),post.sum)
aggregate(tau,list=quantile(data[test,]$dist_police,seq(0.1,1,0.1)),FUN=post.sum)
aggregate(tau,list(quantile(data[test,]$dist_police,seq(0.1,1,0.1))),post.sum)
by(tau,quantile(data[test,]$dist_police,seq(0.1,1,0.1)),post.sum)
by(tau,cut(data[test,]$dist_police,seq(0.1,1,0.1),quantile(data[test,]$dist_police,seq(0.1,1,0.1))),post.sum)
by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0.1,1,0.1))),post.sum)
table(data$dist_police<290)
by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0,1,0.1))),post.sum)
do.call("rbind",by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0,1,0.1))),post.sum))
matplot(do.call("rbind",by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0,1,0.1))),post.sum)))
matplot(do.call("rbind",by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0,1,0.05))),post.sum)))
do.call("rbind",by(tau,cut(data[test,]$dist_police,quantile(data[test,]$dist_police,seq(0,1,0.05))),post.sum))
by(tau,data$dist_police<290,post.sum)
by(tau,data[test,]$dist_police<290,post.sum)
boxplot(by(tau,data[test,]$dist_police<290,post.sum))
by(tau,data[test,]$dist_police<290,colMeans)
boxplot(by(tau,data[test,]$dist_police<290,colMeans))
do.call("rbind",by(tau,cut(data[test,]$dist_pub,quantile(data[test,]$dist_pub,seq(0,1,0.05))),post.sum))
boxplot(by(tau,data[test,]$dist_pub>=51,colMeans))
boxplot(by(tau,data[test,]$dist_pub>=68,colMeans))
by(tau,data[test,]$dist_pub<=52,post.sum)
by(tau,data[test,]$dist_pub<=51,post.sum)
by(tau,data[test,]$dist_pub<=68,post.sum)
by(tau,data[test,]$dist_pub<=80,post.sum)
by(tau,data[test,]$dist_pub<=90,post.sum)
by(tau,data[test,]$dist_pub<=100,post.sum)
by(tau,data[test,]$dist_pub<=95,post.sum)
by(tau,data[test,]$dist_police<290,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_fire>=219,post.sum)
rowMeans(tau)
cor(rowMeans(tau),w[test,])
by(tau,data[test,]$no_sewer==0,post.sum)
by(tau,data[test,]$old_sewer==0,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_theater>=565,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_thea>=565,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_thea<565,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_bank>=621,post.sum)
by(tau,data[test,]$dist_police>=290 & data[test,]$dist_bank>=621 & data[test,]$dist_fire>=219,post.sum)
table(x[test]>=-Owidth & x[test]<=Owidth)
table(x>=-Owidth & x<=Owidth)
test
length(test)
sum(test)
table(x>=-Owidth & x<=Owidth)
by(tau,data[test,]$dist_police<290,post.sum)
by(tau,data$dist_police<290,post.sum)
by(tau,data$dist_police<290 & data$dist_fire<283,post.sum)
summary(cct1)
summary(x)
Owidth <- 0.28
bins
plot(x,y)
plot(x,y,type="b")
plot(x[order(x)],y[order(x)],type="b")
plot(x[order(x)],y[order(x)],type="b")
Owidth
by(tau,data$dist_police<290,post.sum)
tau.pred(pred,burnin,num_sweeps)
pred.tot$yhats.adj.mean
mean((pred.tot$yhats.adj.mean-y)^2)
q("no")
Sys.info()["sysname"]
Sys.info()
1/1:200
pi
install.packages("mnormt")
matrix(1:5,nrow=2)
matrix(1:6,nrow=2)
matrix(1:6,nrow=2,byrow=T)
matrix(c(2,4),c(6,8),c(10,12),nrow=2,byrow=T)
matrix(list(c(2,4),c(6,8),c(10,12)),nrow=2,byrow=T)
dgp.kr(n=10)
dgp.kr(n=1)
dgp.kr(n=10)
dgp.kr(n=1)
2/(1:200)^2
1/8
200^2
2/40000
dgp.kr(n=10)
dgp.kr(n=10)$y
dgp.fh(n=10)
dgp.cgs(10,2)
q("no")
n <- 10
xbcf.sim("cgs")
p <- 2
xbcf.sim("cgs")
xbcf.sim("cgs")
xbcf.sim("cgs")
cutpoints(0.01)
range(x)
list2env(dgp.cgs(10,2))
q("no")
list2env(dgp.cgs(10,2))
list2env(dgp.cgs(10,2))
y
list2env(dgp.cgs(10,2),globalenv())
y
x
w
z
tau
q("no")
q("no")
dgp(10,2,"cgs")
y
x
w
z
tau
findOwidth(0.01)
q("no")
q("no")
q("no")
y
x
Owidth
findOwidth(0.01)
class(w)
class(x)
c <- 0
findOwidth(0.01)
q("no")
q("no")
results.cgs
Owidth
q("no")
results.cgs
q("no")
dim(w)
q("no")
results
q("no")
q("no")
y
x
w
dgp(n,p,"cgs")
y
w
rdd.x(y,x,w)
dgp(n,p,"kr")
rdd.x(y,x,w)
dgp(n,p,"fh")
rdd.x(y,x,w)
y
x
w
dgp(n,p,"kr")
table(z)
q("no")
q("no")
y
q("no")
results
q("no")
